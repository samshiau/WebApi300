<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>Mock OAuth2 Server Example Sign-in</title>

    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" rel="stylesheet">
</head>

<body>
<div class="container">
    <div class="row mt-5 justify-content-md-center">

        <div class="col-md-5">
            <form method="post">

                <h4>Mock OAuth2 Server For Class</h4>
                <h5>For Shopping!</h5>
                <p>This is using OIDC/OAuth2 - but it will allow you, for development and testing, to use any users with
                    any claims.</p>
                <hr class="divisor">
                <div class="row">
                    <div class="col" id="examples"></div>
                    <div class="col">
                        <div class="form-group">
                            <input autofocus="on" class="form-control" name="username"
                                   placeholder="Enter any user/subject"
                                   type="text">
                        </div>

                        <div class="form-group">
                        <textarea class="form-control" name="claims" placeholder="Optional claims JSON value, example:
{
  &quot;acr&quot;: &quot;reference&quot;
}" rows="15"
                        ></textarea>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary topBtn" type="submit"><i class="fa fa-sign-in"></i>Sign-in</button>
            </form>

        </div>
    </div>
</div>
<script>
    const form = document.querySelector('form');
    const userNameEntry = form.querySelector('input[name="username"]');
    const claimsEntry = form.querySelector('textarea[name="claims"]');
    const examplesElement = document.getElementById('examples');
    form.addEventListener('submit', function (event) {
        if (claimsEntry.value) {
            try {
                JSON.parse(claimsEntry.value);
            } catch (e) {
                event.preventDefault();
                alert('Claims value is not valid JSON: ' + e.message);
            }
        }
    })
    const examples = [
        {
            description: 'Example 1 - Bob, just an employee',
            data: {
                username: 'bob',
                claims: `{}`
            }
        },

        {
            description: 'Example 2 - Alice, a Product Manager',
            data: {
                username: 'alice',
                claims: `{
                    "role": ["ProductManager"]
                }`
            }
        }
    ]
    examples.forEach(example => {
        const btn = document.createElement('button');
        btn.className = 'btn btn-success btn-sm my-3';
        btn.textContent = example.description;
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            userNameEntry.value = example.data.username;
            claimsEntry.value = JSON.parse(example.data.claims) ? example.data.claims : '';
        });
        examplesElement.appendChild(btn);
        examplesElement.appendChild(document.createElement('br'));
    })
</script>
</body>

</html>